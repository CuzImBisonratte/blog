"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[931],{9527:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>h});var r=i(1553),t=i(4848),s=i(8453),d=i(5537),a=i(9329);const l={slug:"ap55c-openwrt",title:"Flashen eines Sophos AP 55 (C) / 100 (C) mit OpenWRT",authors:["konstantin"]},o=void 0,c={authorsImageUrls:[void 0]},h=[{value:"Technik &amp; Konzept",id:"technik--konzept",level:2},{value:"Sophos AP 55 vs AP 55C",id:"sophos-ap-55-vs-ap-55c",level:3},{value:"Konzept",id:"konzept",level:3},{value:"Ben\xf6tigte Hardware",id:"ben\xf6tigte-hardware",level:3},{value:"Anleitung",id:"anleitung",level:2},{value:"Schritt 1: Installiere einen TFTP-Server",id:"schritt-1-installiere-einen-tftp-server",level:3},{value:"Schritt 2: Lade die OpenWRT-Firmware herunter",id:"schritt-2-lade-die-openwrt-firmware-herunter",level:3},{value:"Schritt 3: Verbinde den AP mit deinem TFTP-Server",id:"schritt-3-verbinde-den-ap-mit-deinem-tftp-server",level:3},{value:"Schritt 4: Verbinde dich mit der seriellen Konsole des AP",id:"schritt-4-verbinde-dich-mit-der-seriellen-konsole-des-ap",level:3},{value:"Schritt 5: Unterbrich den Bootprozess",id:"schritt-5-unterbrich-den-bootprozess",level:3},{value:"Schritt 6: OpenWRT booten",id:"schritt-6-openwrt-booten",level:3},{value:"Schritt 7: OpenWRT installieren",id:"schritt-7-openwrt-installieren",level:3},{value:"Schritt 8: Abschluss der Installation",id:"schritt-8-abschluss-der-installation",level:3},{value:"Zusammenfassung",id:"zusammenfassung",level:2}];function u(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Die Schule, die ich besuche, musste alle alten Access Points austauschen. Der IT-Leiter fragte zwei meiner Freunde und mich, ob wir versuchen wollten, eine Verwendung f\xfcr die alten Ger\xe4te zu finden, da er sie nicht wegwerfen wollte."}),"\n",(0,t.jsx)(n.p,{children:"Wir haben dar\xfcber nachgedacht und kamen auf die Idee, OpenWRT darauf zu flashen. Es hat funktioniert! Hier ist also, wie wir es gemacht haben!"}),"\n","\n",(0,t.jsxs)(n.admonition,{title:"Zur Anleitung springen",type:"note",children:[(0,t.jsx)(n.p,{children:"Dieser Blogbeitrag enth\xe4lt auch eine kurze Zusammenfassung der Schritte, die wir unternommen haben, um OpenWRT auf dem AP 55C zu flashen."}),(0,t.jsxs)(n.p,{children:["Wenn du nur eine Anleitung m\xf6chtest, kannst du den ersten Teil \xfcberspringen und direkt zur  ",(0,t.jsx)(n.a,{href:"#anleitung",children:"Anleitung"})," kommen."]})]}),"\n",(0,t.jsx)(n.h2,{id:"technik--konzept",children:"Technik & Konzept"}),"\n",(0,t.jsx)(n.p,{children:"Der Sophos AP 55C ist ein drahtloser Access Point, der auf einer propriet\xe4ren Firmware von Sophos l\xe4uft, die bereits auf OpenWRT basiert. Das Ziel war es, die Sophos-Firmware durch eine offenere und anpassbarere Version \u2014 die Standardversion \u2014 von OpenWRT zu ersetzen."}),"\n",(0,t.jsx)(n.h3,{id:"sophos-ap-55-vs-ap-55c",children:"Sophos AP 55 vs AP 55C"}),"\n",(0,t.jsx)(n.p,{children:"Der Sophos AP 55C ist die f\xfcr die Decke vorgesehene Version des Sophos AP 55. W\xe4hrend der AP 55 ein f\xfcr die Wandmontage gedachtes Ger\xe4t mit externen Antennen ist, wurde der AP 55C f\xfcr eine unauff\xe4llige Deckenmontage entworfen."}),"\n",(0,t.jsx)(n.p,{children:"Der wichtige Unterschied ist, dass beide Ger\xe4te einen seriellen Konsolenport haben, der AP 55 jedoch einen simplen RJ45-Port f\xfcr die Konsole verwendet, w\xe4hrend der AP 55C UART-Pins im Inneren des Ger\xe4ts verwendet. Das bedeutet, dass du den AP 55C \xf6ffnen musst, um auf die Konsole zuzugreifen, w\xe4hrend der AP 55 \xfcber ein standartisiertes RJ45-Serial-Kabel nutzbar ist."}),"\n",(0,t.jsx)(n.p,{children:"Das bringt auch unterschiedliche Hardwareanforderungen mit sich. Der AP 55 kann mit einem normalen USB-Serial-Adapter geflasht werden, w\xe4hrend der AP 55C einen UART-Adapter ben\xf6tigt. (Wenn du ein weiteres interessantes Projekt haben m\xf6chtest, kannst du auch einen Raspberry Pi Pico als USB-UART-Br\xfccke verwenden.)"}),"\n",(0,t.jsx)(n.h3,{id:"konzept",children:"Konzept"}),"\n",(0,t.jsx)(n.p,{children:"Das Ziel war es, OpenWRT anstelle der originalen Sophos-Firmware auf dem AP laufen zu lassen."}),"\n",(0,t.jsxs)(n.p,{children:["Daf\xfcr musste man den Bootprozess des Access Points \xfcber die serielle Konsole unterbrechen, ein OpenWRT-Image per TFTP laden und es booten. Danach wird es mit ",(0,t.jsx)(n.code,{children:"sysupgrade"})," fest auf dem Ger\xe4t installiert."]}),"\n",(0,t.jsx)(n.h3,{id:"ben\xf6tigte-hardware",children:"Ben\xf6tigte Hardware"}),"\n",(0,t.jsxs)(d.A,{groupId:"device",children:[(0,t.jsx)(a.A,{value:"55",label:"AP 55",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Ein Sophos AP 55"}),"\n",(0,t.jsxs)(n.li,{children:["Ein USB-Serial RJ45-Adapter  (Ich empfehle ",(0,t.jsx)(n.a,{href:"https://amzn.to/4meEwwE",children:"diesen"}),")"]}),"\n",(0,t.jsx)(n.li,{children:"Ein Computer"}),"\n",(0,t.jsxs)(n.li,{children:["Ein PoE-Switch or -Injector (Wir haben einen ",(0,t.jsx)(n.a,{href:"https://amzn.to/42chkHW",children:"TP-Link TL-PoE160S"})," verwendet)"]}),"\n"]})}),(0,t.jsx)(a.A,{value:"55c",label:"AP 55C",default:!0,children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Ein Sophos AP 55C"}),"\n",(0,t.jsxs)(n.li,{children:["Zwei USB-Serial UART-Adapter  (wir haben ",(0,t.jsx)(n.a,{href:"https://amzn.to/4m8o6ps",children:"diesen"})," verwendet)"]}),"\n",(0,t.jsx)(n.li,{children:"Ein Computer"}),"\n",(0,t.jsx)(n.li,{children:"Ein kleiner Schraubendreher"}),"\n",(0,t.jsxs)(n.li,{children:["Ein PoE-Switch or -Injector (Wir haben einen ",(0,t.jsx)(n.a,{href:"https://amzn.to/42chkHW",children:"TP-Link TL-PoE160S"})," verwendet)"]}),"\n"]})})]}),"\n",(0,t.jsx)(n.h2,{id:"anleitung",children:"Anleitung"}),"\n",(0,t.jsx)(n.p,{children:"Hier sind die Schritte, denen du folgen kannst, um OpenWRT auf den Sophos AP 55 (C) zu flashen."}),"\n",(0,t.jsx)(n.p,{children:"Wie bei der Installation der meisten Betriebssysteme wirst du zuerst ein Live-Image von OpenWRT booten und dann von dort aus die Installation durchf\xfchren. Um das Live-Image zu booten, musst du das Image per TFTP laden."}),"\n",(0,t.jsx)(n.h3,{id:"schritt-1-installiere-einen-tftp-server",children:"Schritt 1: Installiere einen TFTP-Server"}),"\n",(0,t.jsx)(n.p,{children:"Zuerst ben\xf6tigst du einen TFTP-Server auf deinem Computer."}),"\n",(0,t.jsxs)(d.A,{groupId:"os",children:[(0,t.jsx)(a.A,{value:"windows",label:"Windows",children:(0,t.jsxs)(n.p,{children:["Unter Windows habe ich ",(0,t.jsx)(n.a,{href:"https://pjo2.github.io/tftpd64/",children:"TFTPD64"})," als TFTP-Server gesehen. Einfach herunterladen und installieren. Dann kannst du im Programm das TFTP-Verzeichnis ausw\xe4hlen, in dem du auch das OpenWRT-Image ablegen wirst."]})}),(0,t.jsxs)(a.A,{value:"linux",label:"Linux (debian-based)",default:!0,children:[(0,t.jsxs)(n.p,{children:["Unter Linux haben wir ",(0,t.jsx)(n.code,{children:"tftpd-hpa"})," genutzt. Du kannst es mit deinem Paketmanager installieren. Unter Ubuntu/Debian-basierten Distributionen zum Beispiel mit:"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo apt-get install tftpd-hpa\nsudo mkdir /srv/tftp\n"})}),(0,t.jsxs)(n.p,{children:["Der Ordner ",(0,t.jsx)(n.code,{children:"/srv/tftp"})," wird als TFTP-Stammverzeichnis verwendet, in dem du die OpenWRT-Initramfs-Kernel-Datei ablegen wirst."]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"schritt-2-lade-die-openwrt-firmware-herunter",children:"Schritt 2: Lade die OpenWRT-Firmware herunter"}),"\n",(0,t.jsxs)(d.A,{groupId:"device",children:[(0,t.jsxs)(a.A,{value:"55",label:"AP 55",children:[(0,t.jsxs)(n.p,{children:["Als n\xe4chstes musst du die OpenWRT-Firmware f\xfcr den Sophos AP 55 herunterladen. Du findest die Firmware auf der ",(0,t.jsx)(n.a,{href:"https://downloads.openwrt.org/",children:"OpenWRT-Downloadseite"}),"."]}),(0,t.jsx)(n.p,{children:"Bitte pr\xfcfe, ob die aktuelle stabile Version eine Firmware f\xfcr den Sophos AP 55 bereitstellt. Falls nicht, kannst du auch eine \xe4ltere Version verwenden (zum Zeitpunkt des Schreibens ist 24.10.2 die neueste, die den AP 55 unterst\xfctzt)."}),(0,t.jsx)(n.p,{children:"Du findest die Firmware unter:"}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"ath79 -> generic -> sophos_ap55-initramfs-kernel.bin"})}),(0,t.jsx)(n.p,{children:"und"}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"ath79 -> generic -> sophos_ap100-initramfs-kernel.bin"})}),(0,t.jsx)(n.p,{children:"Lade beide Dateien herunter und lege sie in das TFTP-Stammverzeichnis, das du in Schritt 1 eingerichtet hast."}),(0,t.jsxs)(n.p,{children:["Benenne sie dann in ",(0,t.jsx)(n.code,{children:"uImage_AP55"})," und ",(0,t.jsx)(n.code,{children:"uImage_AP100"})," um. (Ohne Dateiendung)"]}),(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"Der AP 55 / AP 100 verwenden nahezu die gleiche Hardware. Daher ben\xf6tigt der AP 55 manchmal die AP 100-Firmware, um ordnungsgem\xe4\xdf zu funktionieren. Lade einfach beide Firmwares herunter, um sicherzugehen, und der AP w\xe4hlt die richtige aus."})})]}),(0,t.jsxs)(a.A,{value:"55c",label:"AP 55C",default:!0,children:[(0,t.jsxs)(n.p,{children:["Als n\xe4chstes musst du die OpenWRT-Firmware f\xfcr den Sophos AP 55C herunterladen. Du findest die Firmware auf der ",(0,t.jsx)(n.a,{href:"https://downloads.openwrt.org/",children:"OpenWRT-Downloadseite"}),"."]}),(0,t.jsx)(n.p,{children:"Bitte pr\xfcfe, ob die aktuelle stabile Version eine Firmware f\xfcr den Sophos AP 55 bereitstellt. Falls nicht, kannst du auch eine \xe4ltere Version verwenden (zum Zeitpunkt des Schreibens ist 24.10.2 die neueste, die den AP 55 unterst\xfctzt)."}),(0,t.jsx)(n.p,{children:"Du findest die Firmware unter:"}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"ath79 -> generic -> sophos_ap55c-initramfs-kernel.bin"})}),(0,t.jsx)(n.p,{children:"und"}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"ath79 -> generic -> sophos_ap100c-initramfs-kernel.bin"})}),(0,t.jsx)(n.p,{children:"Lade beide Dateien herunter und lege sie in das TFTP-Stammverzeichnis, das du in Schritt 1 eingerichtet hast."}),(0,t.jsxs)(n.p,{children:["Benenne sie dann in ",(0,t.jsx)(n.code,{children:"uImage_AP55"})," und ",(0,t.jsx)(n.code,{children:"uImage_AP100"})," um. (Ohne Dateiendung)"]}),(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"Der AP 55 / AP 100 verwenden nahezu die gleiche Hardware. Daher ben\xf6tigt der AP 55 manchmal die AP 100-Firmware, um ordnungsgem\xe4\xdf zu funktionieren. Lade einfach beide Firmwares herunter, um sicherzugehen, und der AP w\xe4hlt die richtige aus."})})]})]}),"\n",(0,t.jsx)(n.h3,{id:"schritt-3-verbinde-den-ap-mit-deinem-tftp-server",children:"Schritt 3: Verbinde den AP mit deinem TFTP-Server"}),"\n",(0,t.jsx)(n.p,{children:"Schlie\xdfe den AP mit einem Ethernet-Kabel an deinen Computer an, auf dem du den TFTP-Server eingerichtet hast."}),"\n",(0,t.jsxs)(n.p,{children:["Setze die IPv4-Adresse deines Computers statisch auf ",(0,t.jsx)(n.code,{children:"192.168.99.8"}),". Der AP wird diese Adresse verwenden, um eine Verbindung zum TFTP-Server herzustellen. Im Folgenden findest du Anweisungen f\xfcr Windows und Ubuntu (mit Gnome). F\xfcr andere Betriebssysteme pr\xfcfe bitte die Dokumentation deines Betriebssystems."]}),"\n",(0,t.jsxs)(d.A,{groupId:"os",children:[(0,t.jsx)(a.A,{value:"windows",label:"Windows",children:(0,t.jsx)(n.p,{children:'Du kannst eine statische IP-Adresse im Netzwerk- und Freigabecenter festlegen. Gehe zu "Adaptereinstellungen \xe4ndern", klicke mit der rechten Maustaste auf deinen Ethernet-Adapter und w\xe4hle "Eigenschaften". W\xe4hle dann "Internetprotokoll Version 4 (TCP/IPv4)" und klicke auf "Eigenschaften". Hier kannst du die statische IP-Adresse festlegen.'})}),(0,t.jsxs)(a.A,{value:"linux",label:"Ubuntu (Gnome)",default:!0,children:[(0,t.jsxs)(n.p,{children:["Unter Ubuntu finde ich es am einfachsten, eine statische IP-Adresse \xfcber die GUI festzulegen. \xd6ffne die Einstellungen und gehe zum Abschnitt ",(0,t.jsx)(n.em,{children:"Netzwerk"}),". Hier kannst du deinen Ethernet-Adapter ausw\xe4hlen und eine statische IP-Adresse festlegen."]}),(0,t.jsx)(n.p,{children:"Das sieht dann ungef\xe4hr so aus:"}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Setting up Static IPv4 Address on Ubuntu 24",src:i(9675).A+"",width:"876",height:"617"})})]})]}),"\n",(0,t.jsx)(n.h3,{id:"schritt-4-verbinde-dich-mit-der-seriellen-konsole-des-ap",children:"Schritt 4: Verbinde dich mit der seriellen Konsole des AP"}),"\n",(0,t.jsxs)(d.A,{groupId:"device",children:[(0,t.jsx)(a.A,{value:"55",label:"AP 55",children:(0,t.jsx)(n.p,{children:"Schlie\xdfe den USB-zu-Seriell RJ45-Adapter an deinen Computer und den AP an."})}),(0,t.jsxs)(a.A,{value:"55c",label:"AP 55C",default:!0,children:[(0,t.jsxs)(n.p,{children:["\xd6ffne den AP 55C mit einem kleinen Schraubendreher.",(0,t.jsx)(n.br,{}),"\n","Die UART-Pins (von links nach rechts, mit RJ45-Port unten) sind:"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Pin 1: VCC (3.3V) \u2014 Nicht verbinden!\nPin 2: GND\nPin 3: RX\nPin 4: TX\n"})}),(0,t.jsx)(n.p,{children:"Verbinde GND, RX und TX mit dem USB-Serial-Adapter. Verbinde den Adapter dann mit deinem Computer."})]})]}),"\n",(0,t.jsxs)(n.p,{children:["Jetzt musst du dich mit der seriellen Konsole des AP verbinden. Du kannst daf\xfcr jedes Terminalprogramm verwenden. Ich empfehle ",(0,t.jsx)(n.a,{href:"https://www.putty.org/",children:"PuTTY"})," f\xfcr Windows und ",(0,t.jsx)(n.code,{children:"minicom"})," f\xfcr Linux:"]}),"\n",(0,t.jsxs)(d.A,{groupId:"os",children:[(0,t.jsxs)(a.A,{value:"windows",label:"Windows",children:[(0,t.jsx)(n.p,{children:"\xd6ffne PuTTY und setze die folgenden Einstellungen:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Verbindungstyp: Serial"}),"\n",(0,t.jsx)(n.li,{children:"Serielle Leitung: COMX (ersetze X durch die Nummer deines COM-Ports)"}),"\n",(0,t.jsx)(n.li,{children:"Geschwindigkeit: 115200"}),"\n"]}),(0,t.jsx)(n.p,{children:'Klicke dann auf "Open", um eine Verbindung zur seriellen Konsole herzustellen.'})]}),(0,t.jsxs)(a.A,{value:"linux",label:"Linux (debian-based)",default:!0,children:[(0,t.jsxs)(n.p,{children:["Du kannst ",(0,t.jsx)(n.code,{children:"minicom"})," und ",(0,t.jsx)(n.code,{children:"screen"})," verwenden, um eine Verbindung zur seriellen Konsole herzustellen. Installiere sie zuerst, falls du das noch nicht getan hast:"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo apt-get install minicom screen\n"})}),(0,t.jsx)(n.p,{children:"Jetzt kannst du dich mit der seriellen Konsole verbinden:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo screen /dev/ttyUSB0 115200\n"})})]})]}),"\n",(0,t.jsx)(n.h3,{id:"schritt-5-unterbrich-den-bootprozess",children:"Schritt 5: Unterbrich den Bootprozess"}),"\n",(0,t.jsx)(n.p,{children:"Starte den AP neu. Falls er schon an den Strom angeschlossen ist, ziehe das Ethernet-Kabel ab und verbinde es wieder mit dem PoE-Switch/-Injector, um ihn neu zu starten."}),"\n",(0,t.jsx)(n.p,{children:"Sobald Ausgabe auf der seriellen Konsole erscheint, dr\xfccke Enter, um den Bootprozess zu unterbrechen. Du solltest eine Eingabeaufforderung wie diese sehen:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ath>\n"})}),"\n",(0,t.jsx)(n.p,{children:"Falls die Ausgabe des Bootloaders unlesbar ist, lie\xdf bitte den nachfolgenden Hinweis:"}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:"Unleserliche Ausgabe auf der seriellen Konsole beheben"}),(0,t.jsxs)(n.p,{children:["Der unleserliche Output wird h\xf6chstwahrscheinlich dadurch verursacht, dass der AP modifiziert wurde, um 7 Datenbits anstelle der standardm\xe4\xdfigen 8 Datenbits f\xfcr TX (",(0,t.jsx)(n.strong,{children:"nicht f\xfcr RX"}),") zu verwenden!"]}),(0,t.jsx)(n.p,{children:"Um dies zu beheben, musst du die RX-Leitung mit dem zweiten USB-zu-Seriell-Adapter verbinden. Die Masse (GND) muss zwischen beiden Adaptern und dem AP geteilt werden. Verbinde dann den zweiten Adapter mit deinem Computer und \xf6ffne ein zweites Terminalprogramm (PuTTY oder minicom)."}),(0,t.jsx)(n.p,{children:'In PuTTY kannst du die Datenbits im Abschnitt "Serial" der Einstellungen festlegen. Setze sie auf 7 Datenbits und verbinde dich mit dem zweiten Adapter.'}),(0,t.jsx)(n.p,{children:"Bei minicom haben wir den folgenden Befehl verwendet, um minicom mit 7 Datenbits zu starten:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo picocom -b 115200 -d 7 -p n -f n /dev/ttyUSB1\n"})}),(0,t.jsx)(n.p,{children:"On the terminal with which you send commands to the AP, you can now type commands. The other terminal will show the output of the AP."}),(0,t.jsxs)(n.p,{children:["The moment the output gets garbage again, switch back to 8 bits by replacing the ",(0,t.jsx)(n.code,{children:"-d 7"})," with ",(0,t.jsx)(n.code,{children:"-d 8"})," in the picocom command or changing it in PuTTY."]}),(0,t.jsx)(n.p,{children:"Im Terminal, mit dem du Befehle an den AP sendest, kannst du jetzt Befehle eingeben. Das andere Terminal zeigt die Ausgabe des AP an."}),(0,t.jsxs)(n.p,{children:["Sobald die Ausgabe wieder unleserlich wird, hat der AP zu 8 Datenbits zur\xfcckgewechselt. Wechsle selber auch einfach zur\xfcck zu 8 Datenbits, indem du ",(0,t.jsx)(n.code,{children:"-d 7"})," durch ",(0,t.jsx)(n.code,{children:"-d 8"})," im picocom-Befehl ersetzt oder es in PuTTY \xe4nderst."]})]}),"\n",(0,t.jsx)(n.h3,{id:"schritt-6-openwrt-booten",children:"Schritt 6: OpenWRT booten"}),"\n",(0,t.jsx)(n.p,{children:"Jetzt kannst du das OpenWRT-Image per TFTP laden und booten. Nutze daf\xfcr die folgenden Befehle:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"tftpboot\nsetenv fwaddr 0x9f070000\nerase $fwaddr +$filesize\ncp.b $fileaddr $fwaddr $filesize\niminfo $fwaddr\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Das wird den AP mit dem Image vom TFTP-Server vorbereiten. Wenn alles funktioniert, solltest du ",(0,t.jsx)(n.code,{children:"Verifying Checksum ... OK"})," in der Ausgabe sehen, dann kannst du das OpenWRT-Live-System mit dem Befehl ",(0,t.jsx)(n.code,{children:"boot"})," starten."]}),"\n",(0,t.jsx)(n.h3,{id:"schritt-7-openwrt-installieren",children:"Schritt 7: OpenWRT installieren"}),"\n",(0,t.jsx)(n.p,{children:"Nachdem OpenWRT gebootet ist, solltest du den AP mit dem Internet verbinden, indem du das Ethernet-Kabel vom TFTP-Server in dein normales Netzwerk steckst."}),"\n",(0,t.jsx)(n.p,{children:"Die Konsolenverbindung wird weiterhin funktionieren, da sie \xfcber UART (AP 55C) oder einen dedizierten Konsolenport (AP 55) bereitgestellt wird."}),"\n",(0,t.jsxs)(n.p,{children:["Ver\xe4ndere danach die Netzwerkkonfiguration des AP, um DHCP zu verwenden, mit dem Texteditor ",(0,t.jsx)(n.code,{children:"nano"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nano /etc/config/network\n"})}),"\n",(0,t.jsx)(n.p,{children:"Ersetze darin die folgenden Zeilen:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",children:"config interface 'lan'\n    option device 'br-lan'\n    // remove-start\n    option proto 'static'\n    option ipaddr '192.168.1.1'\n    option netmask '255.255.255.0'\n    // remove-end\n    // add-start\n    option proto 'dhcp'\n    // add-end\n    option ip6assign '60'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Und verbinde dich mit dem Internet \xfcber DHCP, indem du die folgenden Befehle ausf\xfchrst:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"service network restart\nping -c 1 openwrt.com\n"})}),"\n",(0,t.jsx)(n.p,{children:"Wenn der Ping erfolgreich ist (0% Paketverlust), kannst du jetzt OpenWRT installieren, indem du den folgenden Befehl ausf\xfchrst:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sysupgrade https://downloads.openwrt.org/releases/24.10.2/targets/ath79/generic/openwrt-24.10.2-ath79-generic-sophos_ap100c-squashfs-sysupgrade.bin\n"})}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.p,{children:"Nutze dabei bitte die neueste Version der OpenWRT-Firmware \u2014 dieselbe Version wie das Initramfs-Kernel, das du zum Booten von OpenWRT verwendet hast."}),(0,t.jsxs)(n.p,{children:["Wie beim Initramfs-Kernel k\xf6nnte es sein, dass du die AP 100C-Firmware anstelle der AP 55C-Firmware verwenden musst. Du erkennst das daran, wenn die Installation mit einem Fehler wie ",(0,t.jsx)(n.em,{children:"upgrade: Device sophos,ap55c not supported by this image"})," fehlschl\xe4gt."]})]}),"\n",(0,t.jsx)(n.h3,{id:"schritt-8-abschluss-der-installation",children:"Schritt 8: Abschluss der Installation"}),"\n",(0,t.jsx)(n.p,{children:"Nach der Installation startet der AP neu."}),"\n",(0,t.jsx)(n.p,{children:"Aktiviere DHCP erneut in der Netzwerk-Konfiguration."}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:"DHCP wieder aktivieren"}),(0,t.jsxs)(n.p,{children:["Ver\xe4ndere die Netzwerkkonfiguration des AP, um DHCP zu verwenden, mit dem Texteditor ",(0,t.jsx)(n.code,{children:"nano"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nano /etc/config/network\n"})}),(0,t.jsx)(n.p,{children:"Ersetze darin die folgenden Zeilen:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",children:"config interface 'lan'\n    option device 'br-lan'\n    // remove-start\n    option proto 'static'\n    option ipaddr '192.168.1.1'\n    option netmask '255.255.255.0'\n    // remove-end\n    // add-start\n    option proto 'dhcp'\n    // add-end\n    option ip6assign '60'\n"})}),(0,t.jsx)(n.p,{children:"und verbinde dich mit dem Internet \xfcber DHCP, indem du die folgenden Befehle ausf\xfchrst:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"service network restart\nping -c 1 openwrt.com\n"})}),(0,t.jsx)(n.p,{children:"Wenn der Ping erfolgreich ist (0% Paketverlust), kannst du jetzt weiter machen."})]}),"\n",(0,t.jsx)(n.p,{children:"Finde dann die IP-Adresse des APs mit:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ip a\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Setze ein Passwort f\xfcr den Benutzer ",(0,t.jsx)(n.code,{children:"root"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"passwd\n"})}),"\n",(0,t.jsx)(n.p,{children:"Das wird dann auch das neue Passwort f\xfcr die Weboberfl\xe4che von OpenWRT sein."}),"\n",(0,t.jsxs)(n.p,{children:["Danach kannst du die Weboberfl\xe4che unter ",(0,t.jsx)(n.code,{children:"http://<IP_ADDRESS_OF_YOUR_AP>/"})," \xf6ffnen und dich mit dem Benutzernamen ",(0,t.jsx)(n.code,{children:"root"})," und deinem Passwort anmelden."]}),"\n",(0,t.jsx)(n.p,{children:"Fertig \u2014 OpenWRT l\xe4uft jetzt auf deinem Sophos AP 55 (C) / 100 (C)."}),"\n",(0,t.jsx)(n.h2,{id:"zusammenfassung",children:"Zusammenfassung"}),"\n",(0,t.jsx)(n.p,{children:"Die Installation von OpenWRT auf dem AP ist nicht wirklich schwer und dauert etwa 15\u201330 Minuten, je nach Erfahrung."}),"\n",(0,t.jsx)(n.p,{children:"Da die APs bald ihr End-of-Life bei Sophos erreichen, findet man viele davon g\xfcnstig auf Kleinanzeigen oder eBay. F\xfcr 20\u201330 \u20ac bekommt man damit einen PoE-f\xe4higen Access Point mit ordentlicher Leistung."}),"\n",(0,t.jsx)(n.p,{children:"Ich hoffe, dir hat dieser Blogbeitrag gefallen \u2014 vielleicht betreibst du ja bald auch freie Software auf deinen Ger\xe4ten."}),"\n",(0,t.jsxs)(n.p,{children:["Danke an meine Mitsch\xfcler, die an diesem Projekt mitgearbeitet haben, und danke an den IT-Leiter meiner ",(0,t.jsx)(n.a,{href:"https://lls-bad.de",children:"Schule"}),", der uns die Hardware zur Verf\xfcgung gestellt hat. Auch danke an ",(0,t.jsx)(n.a,{href:"https://forum.openwrt.org/t/howto-installing-openwrt-on-sophos-ap-55-and-ap-100",children:"dieses Tutorial"}),", das einen guten Ausgangspunkt und eine Basis f\xfcr dieses Projekt geboten hat."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Und zum Schluss, danke dir f\xfcrs Lesen!"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},9329:(e,n,i)=>{i.d(n,{A:()=>d});i(6540);var r=i(4164);const t={tabItem:"tabItem_Ymn6"};var s=i(4848);function d({children:e,hidden:n,className:i}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,i),hidden:n,children:e})}},5537:(e,n,i)=>{i.d(n,{A:()=>A});var r=i(6540),t=i(4164),s=i(5627),d=i(6347),a=i(372),l=i(604),o=i(1861),c=i(8749);function h(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:n,children:i}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return h(e).map((({props:{value:e,label:n,attributes:i,default:r}})=>({value:e,label:n,attributes:i,default:r})))}(i);return function(e){const n=(0,o.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,i])}function p({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const i=(0,d.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(t),(0,r.useCallback)((e=>{if(!t)return;const n=new URLSearchParams(i.location.search);n.set(t,e),i.replace({...i.location,search:n.toString()})}),[t,i])]}function f(e){const{defaultValue:n,queryString:i=!1,groupId:t}=e,s=u(e),[d,l]=(0,r.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const i=n.find((e=>e.default))??n[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:s}))),[o,h]=m({queryString:i,groupId:t}),[f,b]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[i,t]=(0,c.Dv)(n);return[i,(0,r.useCallback)((e=>{n&&t.set(e)}),[n,t])]}({groupId:t}),g=(()=>{const e=o??f;return p({value:e,tabValues:s})?e:null})();(0,a.A)((()=>{g&&l(g)}),[g]);return{selectedValue:d,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),b(e)}),[h,b,s]),tabValues:s}}var b=i(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=i(4848);function j({className:e,block:n,selectedValue:i,selectValue:r,tabValues:d}){const a=[],{blockElementScrollPositionUntilNextRender:l}=(0,s.a_)(),o=e=>{const n=e.currentTarget,t=a.indexOf(n),s=d[t].value;s!==i&&(l(n),r(s))},c=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const i=a.indexOf(e.currentTarget)+1;n=a[i]??a[0];break}case"ArrowLeft":{const i=a.indexOf(e.currentTarget)-1;n=a[i]??a[a.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:d.map((({value:e,label:n,attributes:r})=>(0,x.jsx)("li",{role:"tab",tabIndex:i===e?0:-1,"aria-selected":i===e,ref:e=>{a.push(e)},onKeyDown:c,onClick:o,...r,className:(0,t.A)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":i===e}),children:n??e},e)))})}function w({lazy:e,children:n,selectedValue:i}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function v(e){const n=f(e);return(0,x.jsxs)("div",{className:(0,t.A)("tabs-container",g.tabList),children:[(0,x.jsx)(j,{...n,...e}),(0,x.jsx)(w,{...n,...e})]})}function A(e){const n=(0,b.A)();return(0,x.jsx)(v,{...e,children:h(e.children)},String(n))}},9675:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/ipv4-ubuntu-599a4d432ad9ddf87187a1920294aaaa.png"},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>a});var r=i(6540);const t={},s=r.createContext(t);function d(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),r.createElement(s.Provider,{value:n},e.children)}},1553:e=>{e.exports=JSON.parse('{"permalink":"/de/ap55c-openwrt","source":"@site/i18n/de/docusaurus-plugin-content-blog/2025-09-07-sophos-openwrt/index.mdx","title":"Flashen eines Sophos AP 55 (C) / 100 (C) mit OpenWRT","description":"Die Schule, die ich besuche, musste alle alten Access Points austauschen. Der IT-Leiter fragte zwei meiner Freunde und mich, ob wir versuchen wollten, eine Verwendung f\xfcr die alten Ger\xe4te zu finden, da er sie nicht wegwerfen wollte.","date":"2025-09-07T00:00:00.000Z","tags":[],"readingTime":10.69,"hasTruncateMarker":true,"authors":[{"name":"Konstantin Protzen","title":"Hobby-Fullstack-Dev","url":"https://github.com/cuzimbisonratte","imageURL":"/de/img/konstantin.webp","key":"konstantin","page":null}],"frontMatter":{"slug":"ap55c-openwrt","title":"Flashen eines Sophos AP 55 (C) / 100 (C) mit OpenWRT","authors":["konstantin"]},"unlisted":false,"nextItem":{"title":"Automating IR Remote Control with Raspberry Pi Pico","permalink":"/de/radiopi"}}')}}]);